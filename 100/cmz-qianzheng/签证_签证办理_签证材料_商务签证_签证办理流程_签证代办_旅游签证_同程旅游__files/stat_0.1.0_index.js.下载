!function(t){var e=t.STATKIT=t.STATKIT||{},r=e.statutil=e.statutil||{};r.require=function(t,e){function r(){o.onload=o.onerror=o.onreadystatechange=null,n||i.removeChild(o),o=null,e&&e()}function a(){var t,r=o.sheet;if(f)r&&(t=!0);else try{r.cssRules&&(t=!0)}catch(n){"NS_ERROR_DOM_SECURITY_ERR"===n.name&&(t=!0)}t?e&&e():--p>0&&setTimeout(a,20)}var t=t.replace(/\s/g,""),n=/\.css$/.test(t),i=$("head")[0],o=null,s="statid"+ +new Date;n?(o=document.createElement("link"),o.rel="stylesheet",o.href=t):(o=document.createElement("script"),o.src=t),o.id=s;var f=+navigator.userAgent.replace(/.*(?:AppleWebKit|AndroidWebKit)\/?(\d+).*/i,"$1")<536,c="onload"in o;if(n&&(f||!c))return void a();c?(o.onload=r,o.onerror=function(){r()}):o.onreadystatechange=function(){/loaded|complete/.test(o.readyState)&&r()},i.appendChild(o);var p=100},r.cookie=function(t,e,r){if("undefined"==typeof e){var a=null;if(document.cookie&&""!=document.cookie){var n=document.cookie.split(";");if(n)for(var i=0;i<n.length;i++){var o=$.trim(n[i]);if(t&&o.substring(0,t.length+1)==t+"="){a=decodeURIComponent(o.substring(t.length+1));break}}}return a}r=r||{},null===e&&(e="",r.expires=-1);var s="";if(r.expires&&("number"==typeof r.expires||r.expires.toUTCString)){var f;"number"==typeof r.expires?(f=new Date,f.setTime(f.getTime()+24*r.expires*60*60*1e3)):f=r.expires,s="; expires="+f.toUTCString()}var c=r.path?"; path="+r.path:"",p=r.domain?"; domain="+r.domain:"",d=r.secure?"; secure":"";document.cookie=[t,"=",encodeURIComponent(e),s,c,p,d].join("")},r.flatParam=function(t){var e=$.extend({},t);for(var r in t){var a=t[r];if(a&&a.indexOf&&a.indexOf("-")>-1)for(var n=a.split("-"),i=0;i<=n.length-1;i++)e[r+i]=n[i];else e[r]=a}return e},r.getParam=function(t,e){var r=new RegExp("[?&]("+e+"=([^&#$]*))","i"),a=r.exec(t);return a?a[2]:""},r.addParam=function(t,e,r){t=t.replace(/(^\s*)|(\s*$)/g,"");var a=/javascript:/i;if(a.test(t))return t;var n=new RegExp("[?&]("+e+"=([^&#$]*))","i"),i=n.exec(t),o=t.split("#"),s=e+"="+r,f=t;return f=i?t.replace(i[1],e+"="+i[2]):/\?/g.test(t)?o.length>1?o[0]+"&"+s+"#"+o[1]:o[0]+"&"+s:o.length>1?o[0]+"?"+s+"#"+o[1]:o[0]+"?"+s};var a=e.statsend=e.statsend||{};a.config={prefix:"//wx.17u.cn/intervacation/stat",browserCfg:{def:{ie:/trident\/([\w.]+)/i,oldie:/msie\s([\w.]+)/i,chrome:/chrome\/([\w.]+)/i,firefox:/firefox\/([\w.]+)/i,app:/TcTravel\/([\w.]+)/i,weixin:/MicroMessenger\/([\w.]+)/i,uc:/UCBrowser\/([\w.]+)/i,baidubox:/baiduboxapp\/([\w.]+)/i,qqbrowser:/mqqbrowser\/([\w.]+)/i},extra:{chrome:/chrome\/([\w.]+)/i,safari:/safari\/([\w.]+)/i}}},a.getBrowser=function(t,e){for(var r in e){var a=r,n=e[a].exec(t);if(n)return{browser:a,version:n[1]||"0",ua:t,bv:a+(n[1]||"0")}}},a.browser=function(t){var e=this,r=e.config.browserCfg,a=e.getBrowser(t,r.def);return a||(a=e.getBrowser(t,r.extra)),a||{browser:"other",version:"0",ua:t}},a.ua=function(){var t=this;if(t.uaData)return t.uaData;var e=navigator.userAgent;return t.uaData=$.extend({},t.platform(e),t.browser(e)),t.uaData},a.platform=function(t){var e={android:/android\s([\w.]+)/i,ios:/iphone\sos\s([\w.]+)/i,window:/Windows\sNT\s([\w.]+)/i},r="other";for(var a in e){var n=a,i=e[n].exec(t);i&&(r=n+(i[1]||"0"))}return{platform:r}},a.stringify=function(e){return"string"===(typeof e).toLowerCase()?e:t.JSON&&JSON.stringify?JSON.stringify(e):'{"message":"不支持stringify"}'},a.send=function(e){var r=new Image,a="__img__"+Math.random();t[a]=r,r.onload=r.onerror=function(){t[a]=null},r.src=e,r=null},a.stat=function(t,e){var r=this,a=r.ua(),n={host:location.host,errortype:"stat-"+t,url:encodeURIComponent(location.href),jobnumber:$&&$.cookie&&$.cookie("jobnumber")||""},i=$.extend(n,a),o=r.stringify($.extend(i,e));r.send(r.config.prefix+"?frontlog="+o)};var n=e.statXpath=e.statXpath||{};n.config={headchar:"!",indexChar:"^",limit:6,sepchar:"|"},n.get=function(t){var e=this,r=e.config,a=e.parents(t);a.reverse();for(var n=r.headchar,i=0;i<a.length;i++)n+=a[i].sizzle,a[i].index&&(n+=r.indexChar+a[i].index),i<a.length-1&&(n+=r.sepchar);return n},n.parents=function(t){for(var e=this,r=e.config.limit,a=[],n=null;r-->0&&t&&9!==t.nodeType;){if(1===t.nodeType){n={},n.elem=t;var i=/[\t\r\n\f]/g,o=t.id;if(o)n.sizzle="*"+o,r=0;else{var s=t.className,f=!1;if(s){for(var c=s.replace(i," ").split(" "),p="",d=0;d<c.length;d++)if(c[d]&&!/hover|active|clearfix|clear/i.test(c[d])){p+=c[d];break}if(p){n.sizzle="."+p,n.index=e.index(t,{type:"class",sizzle:p});var f=!0}}if(!f){var u=t.tagName.toLowerCase();n.sizzle=u,n.index=e.index(t,{type:"tagname",sizzle:u})}}0===r&&n.index&&r++,a.push(n)}t=t.parentNode}return a},n.index=function(t,e){var r=["default","class","tagname"];e=e||{},e.type=e.type.toLowerCase()||r[0];for(var a=[];(t=t.previousSibling)&&9!==t.nodeType;)if(1===t.nodeType){if(e.type==r[0]&&a.push(t),e.type==r[1]){var n=/[\t\r\n\f]/g,i=e.sizzle,o=" "+t.className+" ",i=" "+i+" ";o.replace(n," ").indexOf(i)>=0&&a.push(t)}e.type==r[2]&&t.tagName.toLowerCase()==e.sizzle&&a.push(t)}return e.subs?a:a.length};var i=e.statperf=e.statperf||{};i.config={timestart:new Date-1,effectStay:{maxEffect:3e5,total:0,cache:0,pretime:null}},i.setPerfEvent=function(){var t=this;t.calcStayTime()},i.calcStayTime=function(){var t=this,e=t.config,r=e.effectStay;r.pretime||(r.pretime=e.timestart,r.acttime=e.timestart);var a=new Date-1;a-r.maxEffect>r.pretime?(r.total+=r.cache,r.cache=0,r.acttime=a,r.pretime=a):(r.cache=a-r.acttime,r.pretime=a)},i.sendPerf=function(r){var n=this,i=n.config,o=t.performance||t.mozPerformance||t.msPerformance||t.webkitPerformance;if(o){var s=o.timing,f={app:s.domainLookupStart-s.navigationStart,dns:s.domainLookupEnd-s.domainLookupStart,network:s.requestStart-s.domainLookupStart,send:s.responseStart-s.requestStart,backend:s.responseEnd-s.requestStart,frontend:s.loadEventEnd-s.responseEnd,interactive:s.domInteractive-s.navigationStart,domReady:s.domContentLoadedEventStart-s.navigationStart,load:s.loadEventEnd-s.navigationStart};if(s.msFirstPaint&&(f.firstPaint=s.msFirstPaint),t.chrome&&t.chrome.loadTimes){var c=t.chrome.loadTimes();f.firstPaint=Math.round(1e3*(c.firstPaintTime-c.startLoadTime))}f.pageStay=new Date-1-i.timestart,f.effectStay=i.effectStay.total+i.effectStay.cache,f.url=encodeURIComponent(location.href),f.pageid=e.config.param.pageid,f.jobnumber=$&&$.cookie&&$.cookie("jobnumber")||"";var p=a.config.prefix,d=a.stringify($.extend(f,r||{}));a.send(p+"?key=frontPerf&frontlog="+d)}},e.getUrlRefId=function(){var t=location.href,e=/[#\?&]refid=(\d+)/i.exec(t);return e&&e[1]||""},e.getRefId=function(){var t=this.getUrlRefId();if(t)return r.cookie("17uCNRefId",t),t;var e=r.cookie("17uCNRefId")||"",a=/\bRefId=(\d*)\b/,n=a.exec(e);return n?(r.cookie("17uCNRefId",n[1]),n[1]):/\D/.test(e)?"":e},e.getPageId=function(){var t=$("html").attr("trace");return t},e.config={exclude:["#header","#footer",".stat-toolbar-wrapper",".stat-ui-root"],policy:{pv:!0,spm:!0,biz:!0,form:!0,perf:!0},spminfo:{key:"spmid",sep:"~",attr:"stat-spm",host:t.location.host},forminfo:{sep:"~",head:"@"},statinfo:{point:"statspot",trace:"statkit",form:"statform"},bizinfo:{point:"trackspot",type:"tracktype",track:"trackkit"}},e.initial=function(e,r){var a=this,i=a.config;e=e||{},i.globalParam=e.param||{},e.policy&&$.extend(i.policy,e.policy),e.xpath&&$.extend(n.config,e.xpath||{}),t.setTimeout(function(){$.extend(i.globalParam,t.__stat_param__||{}),i.spmParam=a.getSpotSPM()||{},i.param=$.extend({},i.spmParam,i.globalParam),i.extraParam={refid:a.getRefId(),refer:encodeURIComponent(document.referrer||""),pageid:a.getPageId()},$.extend(i.param,i.extraParam),a.initStatPv(),a.initStatPerf(),a.initStatSpot(),a.initStatUi(),r&&r.call(this)},1e3)},e.initStatPv=function(){var t=this,e=t.config;e.policy.pv&&a.stat("pv",e.param)},e.initStatPerf=function(){var e=this,r=e.config;r.policy.perf&&$(t).on("beforeunload unload",function(){e.isTriggerUnload||(e.isTriggerUnload=!0,i.sendPerf(r.globalParam))})},e.initStatSpot=function(){var t=this,e=t.config,r=$(document);r.on("mousedown","a,button,["+e.statinfo.point+"],["+e.bizinfo.point+"],.J_Trace,.J_trace",function(){t.setSpotEvent(this),i.setPerfEvent()}),r.on("mouseenter","["+e.bizinfo.point+"]",function(){t.setBizTrack(this,"hover")}),r.on("mousedown","["+e.statinfo.form+"]",function(){t.setFormEvent(this)})},e.initStatUi=function(){if(window.self==window.top)return!1;var t=r.getParam(window.location,"stattoken"),e=window.sessionStorage&&sessionStorage.getItem("statToken");if(t)window.sessionStorage&&sessionStorage.setItem("statToken",t);else{if(!e)return!1;t=e}$.ajax({dataType:"jsonp",url:"http://10.101.40.81/board/checkstattoken?stattoken="+t,success:function(t){var e=t.data;4e3==t.code&&(r.require(e.css),r.require(e.js))},failure:function(){window.console&&window.console("验证token失败")}})},e.isExclude=function(t){for(var e=this,r=e.config,a=r.exclude||[],n=!1,i=$(t),o=0;o<a.length;o++)i.parents(a[o]).length>0&&(n=!0);return n},e.setSpotEvent=function(t){var e=this,r=e.config;if(e.isExclude(t))return!1;var a=$(t).attr("rel");if("nospm"==a)return!1;var n=e.getSpotTrace(t);r.param.pageid&&n.unshift(r.param.pageid);var i=$(t).attr(r.statinfo.trace);if(i)/^[A-z]+$|^\d+$|auto__\d+$/.exec(i)&&(i=n[n.length-1]+"___"+i),n.push(i);else{var o=e.getSpotXpath(t);n.push(o)}e.setSpotSPM(t,n),e.setBizTrack(t),e.sendSpotInfo(t,n)},e.setFormEvent=function(t){var e=this,r=e.config;if(e.isExclude(t))return!1;var a=$(t),n=e.getSpotTrace(t),i=a.attr(r.statinfo.form);if(i!==n[n.length-1])return!1;var o=a.parents("["+r.statinfo.trace+"="+i+"]");if(!o.length)return!1;var s=r.forminfo.head+e.getSpotForm();e.sendSpotInfo(t,s)},e.getSpotTrace=function(t){var e=this,r=e.config,a=$(t),n=[],i=a.parents("["+r.statinfo.trace+"]"),o=i.length;return o&&(i.each(function(){n.push(this.getAttribute(r.statinfo.trace))}),n.reverse()),n},e.getSpotXpath=function(t){return n.get(t)},e.getSpotForm=function(t){var e=this,r=e.config,a=[];return t.find("input").each(function(){a.push($(this).val()||0)}),a.join(r.forminfo.sep)},e.getSpotSPM=function(){var t=this,e=t.config;if(e.policy.spm){var a=location.href,n={},i=r.getParam(a,e.spminfo.key);return i||(i=r.getParam(document.refer||"",e.spminfo.key)),i&&(n={spm:i}),n}},e.setSpotSPM=function(t,e){var a=this,n=a.config,i=n.param.spm;if(n.policy.spm){var o=$(t),s=o.attr("data-spm"),f=o.attr("href");JelemSpm=o.parents("["+n.spminfo.attr+"]");var c="",p=[],d=e.length;if(!s&&!/^javascript:|^#|spmid=/.test(f)&&(!n.spminfo||!/^[https?:]*?\/\//i.test(f)||f.indexOf(n.spminfo.host)>-1))if(i&&(JelemSpm.length||(c=i)),c||(p[0]=e.length>1?e[0]:"",p[1]=e[d-1]||"",e.length>2&&p.push(e[d-2]),c=p.join(n.spminfo.sep)),f){var u=r.addParam(f,n.spminfo.key,c);o.attr("href",u)}else o.attr("data-spm",c)}},e.setBizTrack=function(t,e){var r=this,a=r.config,n=a.param.pageid;if(a.policy.biz){var i=t.getAttribute(a.bizinfo.point);if(i){var o=t.getAttribute(a.bizinfo.type);if(!e||o&&o===e){var s=$(t).parents("["+a.bizinfo.track+"]"),f="";s.length&&(f=s.eq(0).attr(a.bizinfo.track)||""),e=e||"click";try{window._tcTraObj&&_tcTraObj._tcTrackEvent(n,e,f,i)}catch(c){}}}}},e.sendSpotInfo=function(t,e,r){var n=this,i=n.config;r=r||{};for(var o=e,s=i.param||{},f=0;f<o.length;f++)s["trace"+f]=o[f];r.lazy?window.__stat_stack__={method:"stat",type:"trace",data:s}:a.stat("trace",s)}}(window);
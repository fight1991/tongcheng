(function(){fish.extend({mSlider:function(o,Z){function j(){for(var d="",c=0;c<aC;){d+="<li><img src="+fish.all("a",am[c++]).attr("small")+" /></li>"}return d}function Y(e){e=0;for(var d=aw.removeClass("current"),f=0;f<d.length;f++){this===d[f]&&(e=f)}fish.one(this).addClass("current");ah(e)}function ah(a){al=aG;if(!aI.circle||!ak){aG=a,aI.circle||(aG>=aC?aG=0:0>aG&&(aG=aC-1)),aF.index=aG,aF.boundary=0===aG?"begin":aG===aC-ab?"end":!1,aG>al?(aI.beforeNextFn&&"function"===typeof aI.beforeNextFn&&aI.beforeNextFn(aF),X(aI.nextFn)):aG<al&&(aI.beforePrevFn&&"function"===typeof aI.beforePrevFn&&aI.beforePrevFn(aF),X(aI.prevFn))}}function W(){(!aI.circle||!ak)&&ah(aG+1)}function V(){(!aI.circle||!ak)&&ah(aG-1)}function ag(){aD&&clearTimeout(aD);aD=setTimeout(aa,aI.moveTime)}function af(){clearTimeout(aD)}function X(a){switch(aI.aniType){case"slide":aG>aC-1&&(aG=0);if(aI.circle&&aG<al){for(var d=aI.scrollNum,c=0;c<d;c++){fish.one(aB).html("top",fish.all(aI.content+":last-child",ae))}aB.css(av+":"+-au+"px");au=0}U=aI.circle?-au:-aG*au;ak=aB.anim(av+":"+U+"px",300,function(){if(aI.circle){if(aG<al){au=aA*aI.scrollNum,aG++}else{var g=aI.scrollNum;if("scrollLeft"==aI.direction||"scrollTop"==aI.direction){for(var b=0;b<g;b++){fish.one(aB).html("bottom",fish.all(aI.content+":first-child",ae))}}else{for(b=0;b<g;b++){fish.one(aB).html("top",fish.all(aI.content+":last-child",ae))}}aB.css(av+":0px");aG--;0>aG&&(aG=aC-1)}}a&&"function"===typeof a&&a(aF);ak=null});break;case"fade":!az||!ay?(at=fish.one(ar[aG]),az=ax.anim(aq,aI.fadeTime,function(){ax.css("display: none;");az=null;ax=at}),ay=at.css("display:block;").anim(aj,aI.fadeTime,function(){a&&"function"===typeof a&&a(aF);ay=null})):(az&&(az.stop(),fish.one(az.elem).css("display: none;"+aq),az=null),ay&&(ay.stop(),ax=fish.one(ay.elem),ay=null,at=fish.one(ar[aG]),az=fish.one(ax).anim(aq,aI.fadeTime,function(){ax.css("display: none;");az=null;ax=at}),ay=at.css("display:block;").anim(aj,aI.fadeTime,function(){a&&"function"===typeof a&&a(aF);ay=null})))}aw&&(aw.removeClass("current"),fish.one(aw[aG]).addClass("current"))}function aa(){"scrollLeft"==aI.direction||"scrollTop"==aI.direction?W():V();aD=setTimeout(aa,aI.moveTime)}if(this[0]){var aI={scrollNum:1,autoScroll:!0,moveTime:3500,direction:"scrollLeft",circle:!1,canvas:".mSlider_con ul",content:".mSlider_con li",nav:".mSlider_nav li",showNav:"orange",aniType:"slide",fadeTime:240,arrows:!1,arrowTheme:!1,prevFn:!1,nextFn:!1,prevBtn:!1,nextBtn:!1};fish.lang.extend(aI,o);var aj,aq,ap,ab=1,U=0,aG=0,am=fish.all(aI.content,this),aC=am.length,aB=fish.all(aI.canvas,this),ae=this,aw,ak,az,ay,aA,av,aH,au,aD,ar,ax,at,i=aC,al,aF={};if(aI.arrows){if(!aI.prevBtn&&!aI.nextBtn){switch(aI.arrowTheme){default:fish.one(this[0].parentNode).html("top",'<div id="id_mSlider_prev" class="mSlider_arrow mSlider_prev group_left"><span id="tg_last" class="mSlider_arrow_inner mSlider_prev_inner btn01_a"></span></div>'),fish.one(this[0].parentNode).html("bottom",'<div id="id_mSlider_next" class="mSlider_arrow mSlider_next group_right"><span id="tg_next" class="mSlider_arrow_inner mSlider_next_inner btn02_a"></span></div>'),ao=fish.dom("#tg_last"),ap=fish.dom("#tg_next")}}else{ao=(ao=fish.dom(aI.prevBtn,this))?ao:fish.dom(aI.prevBtn),ap=(ap=fish.dom(aI.nextBtn,this))?ap:fish.dom(aI.nextBtn)}}"x"==aI.direction?aI.direction="scrollLeft":"y"==aI.direction&&(aI.direction="scrollTop");switch(aI.direction){case"scrollLeft":case"scrollRight":av="left";aH="width";aA=am.width();ab=parseInt(fish.one(aB[0].parentNode).width()/aA,10);break;case"scrollTop":case"scrollBottom":av="top";aH="height";aA=am.height();ab=parseInt(fish.one(aB[0].parentNode).height()/aA,10);break;default:av="left",aH="width",aA=am.width()}au=aA*aI.scrollNum;"custom"!==aI.showNav&&this.css("position:relative;overflow:hidden;");aB.css("position:relative;"+aH+":"+(aC+1)*aA+"px");"fade"===aI.aniType&&(fish.browser("ms",8)||fish.browser("ms",6)||fish.browser("ms",7)?(aj="filter:alpha(opacity=100);",aq="filter:alpha(opacity=1);"):(aj="opacity:1;",aq="opacity:0.01"),aB.css(aH+":"+aA+"px"),ar=fish.all(aI.content,ae),ar.css("display: none;"+aq),ax=fish.one(ar[0]),ax.css("display: block;"+aj),ar.each(function(b){fish.one(b).css("position: absolute; z-index: "+i--+";top: 0; left: 0;")}));aI.autoScroll&&(aD=setTimeout(aa,aI.moveTime),"custom"===aI.showNav?(fish.all(aI.canvas,this).hover(af,ag),fish.all(aI.userNav,this).hover(af,ag)):this.hover(af,ag));if(aI.showNav){aH="";var ad,an,ac,ao;switch(aI.showNav){case"orange":aH+="<ul class='mSlider_nav_orange mSlider_nav'>";for(var aE=0,ai=aC;aE<ai;aE++){aH+="<li><a href='javascript:void(0)'>"+(aE+1)+"</a></li>"}this.html("bottom",aH+"</ul>");break;case"bottom-green":aH='<div class="mSlider_nav_bg"></div><div class="mSlider_nav_bottom_green mSlider_nav clearfix"><div class="holder clearfix">';ad=fish.all("a",aB);ac=aA*aI.scrollNum/aC+"px";aE=0;for(ai=aC;aE<ai;aE++){an=fish.one(ad[aE]).attr("title"),aH+='<a style="width:'+ac+';" href="javascript:void(0);" title="'+an+'"><span>'+an+'</span><i class="outter">\u25c6</i></a>'}aH+="</div></div>";this.html("bottom",aH);aI.nav=".mSlider_nav a";break;case"earth-yellow":aH='<div class="mSlider_nav_bg"></div><div class="mSlider_nav_earth_yellow mSlider_nav clearfix"><div class="holder clearfix">';ad=fish.all("a",aB);ac=aA*aI.scrollNum/aC+"px";aE=0;for(ai=aC;aE<ai;aE++){an=fish.one(ad[aE]).attr("title"),aH+='<a style="width:'+ac+';" href="javascript:void(0);" title="'+an+'"><span>'+an+'</span><i class="outter">\u25c6</i></a>'}aH+="</div></div>";this.html("bottom",aH);aI.nav=".mSlider_nav a";break;case"thumbnail":aH+="<ul class='mSlider_nav_thumbnail mSlider_nav clearfix'>";aH+=j();aH+="</ul>";this.html("bottom",aH);break;case"custom":aI.nav=aI.userNav}aw=aI.userNav?fish.all(aI.nav):fish.all(aI.nav,this);if("thumbnail"===aI.showNav){aw.hover(Y,function(){})}else{aw.on("mouseover",Y)}}fish.one(aw).addClass("current");aF.startScroll=ag;aF.stopScroll=af;aF.scrollTo=ah;aF.scrollNext=W;aF.scrollPrev=V;aF.boundary="begin";aF.index=0;ao&&ap&&(fish.one(ao).on("click",function(){(aI.circle||"begin"!==aF.boundary)&&aF.scrollPrev()}),fish.one(ap).on("click",function(){(aI.circle||"end"!==aF.boundary)&&aF.scrollNext()}));Z&&Z(aF);return aF}}})})();
